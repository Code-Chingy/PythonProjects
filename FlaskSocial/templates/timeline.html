{% extends 'structure.html' %} {% import "bootstrap/wtf.html" as wtf %} {% block body %}

<!--link rel="stylesheet" href="/static/assets/bootstrap/css/bootstrap.min.css"-->

<script src="/static/javascript/timeline.js"></script>

<main class="main">
  <!-- Breadcrumb-->
  <ol class="breadcrumb">
    <li class="breadcrumb-item">My Timeline</li>
    </li>
  </ol>
  <div class="container-fluid">
    <div class="animated fadeIn"></div>
    {% with flashes = get_flashed_messages() %} {% if flashes %} {% for flash in flashes %} {% if flash.category == 'success'%}
    <div class="alert alert-success" role="alert">{{ flash }}</div>
    {% elif flash.category == 'error' %}
    <div class="alert alert-danger" role="alert">{{ flash }}</div>
    {% else %}
    <div class="alert alert-success" role="alert">{{ flash }}</div>
    {% endif %} {% endfor %} {%endif%} {% endwith %}
    <div id="alert" class="alert.hide alert-success" role="alert"></div>

    <div class="row">
      <div class="col-sm-6 col-lg-3">
        <div class="card text-white bg-primary">
          <div class="card-body pb-0">
            <div class="btn-group float-right">
              <button class="btn btn-transparent dropdown-toggle p-0" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="icon-settings"></i>
              </button>
              <div class="dropdown-menu dropdown-menu-right">
                <a class="dropdown-item" href="#">Action</a>
                <a class="dropdown-item" href="#">Another action</a>
                <a class="dropdown-item" href="#">Something else here</a>
              </div>
            </div>
            <div class="text-value">All Friends</div>
            <div>Members online</div>
          </div>
          <div class="chart-wrapper mt-3 mx-3" style="height:70px;">
            <canvas class="chart" id="card-chart1" height="70"></canvas>
          </div>
        </div>
      </div>
      <!-- /.col-->
      <div class="col-sm-6 col-lg-3">
        <div class="card text-white bg-info">
          <div class="card-body pb-0">
            <button class="btn btn-transparent p-0 float-right" type="button">
              <i class="icon-location-pin"></i>
            </button>
            <div class="text-value">Online Friends</div>
            <div>Members online</div>
          </div>
          <div class="chart-wrapper mt-3 mx-3" style="height:70px;">
            <canvas class="chart" id="card-chart2" height="70"></canvas>
          </div>
        </div>
      </div>
      <!-- /.col-->
      <div class="col-sm-6 col-lg-3">
        <div class="card text-white bg-warning">
          <div class="card-body pb-0">
            <div class="btn-group float-right">
              <button class="btn btn-transparent dropdown-toggle p-0" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="icon-settings"></i>
              </button>
              <div class="dropdown-menu dropdown-menu-right">
                <a class="dropdown-item" href="#">Action</a>
                <a class="dropdown-item" href="#">Another action</a>
                <a class="dropdown-item" href="#">Something else here</a>
              </div>
            </div>
            <div class="text-value">Apps</div>
            <div>Members online</div>
          </div>
          <div class="chart-wrapper mt-3" style="height:70px;">
            <canvas class="chart" id="card-chart3" height="70"></canvas>
          </div>
        </div>
      </div>
      <!-- /.col-->
      <div class="col-sm-6 col-lg-3">
        <div class="card text-white bg-danger">
          <div class="card-body pb-0">
            <div class="btn-group float-right">
              <button class="btn btn-transparent dropdown-toggle p-0" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="icon-settings"></i>
              </button>
              <div class="dropdown-menu dropdown-menu-right">
                <a class="dropdown-item" href="#">Action</a>
                <a class="dropdown-item" href="#">Another action</a>
                <a class="dropdown-item" href="#">Something else here</a>
              </div>
            </div>
            <div class="text-value">Games</div>
            <div>Members online</div>
          </div>
          <div class="chart-wrapper mt-3 mx-3" style="height:70px;">
            <canvas class="chart" id="card-chart4" height="70"></canvas>
          </div>
        </div>
      </div>
      <!-- /.col-->
    </div>
  </div>

  <div class="card">
    <div class="card-header">News Feed
      <div class="card-header-actions">
        <a class="card-header-action">
          <small class="text-muted"></small>
        </a>
      </div>
    </div>
    <div class="card-body">
      <div class="scrollspy-example1">
        <form method="POST"  enctype="multipart/form-data" action="/post">
          {{ form.hidden_tag() }}
          <nav class="navbar navbar-light bg-light" id="navbar-example1" style="padding: .5rem 1rem;">
            <textarea class="form-control" required="" rows="6" name="postbox" id="postbox" placeholder="What's on your mind"></textarea>
            <ul class="nav nav-pills" role="tablist">
              <li class="nav-item">
                <button class="nav-link active" id='post' name="post" type="submit">Post</button>
              </li>
              <li class="nav-item">
                <a class="nav-link">
                  <input type="file" value="Add Media" name="media" multiple="" style="background-image:url(&quot;none&quot;);background-color:#da052b;color:#fff;margin:0px 0px 6px;border:none;box-shadow:none;text-shadow:none;opacity:0.9;text-transform:uppercase;font-weight:bold;font-size:13px;letter-spacing:0.4px;line-height:1;outline:none;">
                </a>
              </li>
              <li class="nav-item dropdown">
                <!--a onmousemove="showprivacy()" class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Privacy</a>
                  <div type="select" id="privacymenu" onmouseleave="hideprivacy()" >
                    <a class="dropdown-item" target="_top">Public</a>
                    <a class="dropdown-item" target="_top">Private</a>
                    <div class="dropdown-divider" role="separator"></div>
                    <a class="dropdown-item" target="_top">Only friends</a>
                  </div-->
                <select name="privacy" id="privacy" style="border:2px solid;margin:0px 0px 6px; border-radius:4px; width:110px; height:26px; border:3px solid #da052b;">
                  <option class="dropdown-item" value="public">Public</option>
                  <option class="dropdown-item" value="private">Private</option>
                  <option class="dropdown-item" value="only_friends">Only Friends</option>
                </select>
              </li>
            </ul>
          </nav>
        </form>
      </div>
    </div>


    
    <div class="col-md-6">
      <ul id="list-group" class="list-group">

        {% for post in get_news_feed(user, 0) %} {% if post != 'reachedMax' %} 
        {% with uzer = get_user(userid=post.user_id) %} 
        {% if uzer %}
        <li class="list-group-item" id='delete{{post.post_id}}'>
          <blockquote>
            <div>
              <img style=" max-width: 50px; height: 50px; border-radius: 50em;"
                {% if uzer.profile_pic %} 
                  src="{{ user.profile_pic }}" 
                  {% else %} 
                    {% if uzer.gender=="male" %} 
                      src="/static/avatar/block-male.png"
                    {% elif uzer.gender=="female" %} 
                      src="/static/avatar/block-female.png" 
                    {% else %} 
                      src="/static/avatar/default-black.png"
                    {% endif %}
                {% endif %} alt="Friend">
              <b>@{{ uzer.username }}</b>
            </div>
            <article>
              {% if post.post_content['media'] != [] %}
                {% for media in post.post_content['media'] %}
                  {% if media['filetype'] == 'photo' %}
                      <center><img src="{{ (media['path'])[0] }}"  width="80%" height="100%" ></center>
                  {% elif media['filetype'] == 'audio' %}
                      <center><img src='/static/avatar/audio.png'  width="150" height="100" ></center>
                      <center><a  href="{{ (media['path'])[0] }}">Listen to {{ media['filename'] }}</a></center>
                  {% elif media['filetype'] == 'video' %}
                      <center> <img src='/static/avatar/video.png'  width="150" height="100" ></center>
                      <center><a  href="{{ (media['path'])[0] }}">Watch {{ media['filename'] }}</a></center>
                  {% elif media['filetype'] == 'document' %}
                      <center> <img src='/static/avatar/document.png'  width="150" height="100" ></center>
                      <center><a  href="{{ (media['path'])[0] }}">View {{ media['filename'] }}</a></center>
                  {% elif media['filetype'] == 'batch' %}
                        <div class="carousel slide" id="carouselExampleIndicators" data-ride="carousel">
                          <ol class="carousel-indicators">
                            <li class="active" data-target="#carouselExampleIndicators" data-slide-to="0"></li>
                            <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
                            {% if len(media['path']) >= 2 %}
                                {% for x in range(2, len(media['path'])) %}
                                    <li data-target="#carouselExampleIndicators" data-slide-to="{{x}}"></li>
                                {% endfor %}
                            {% endif %}
                          </ol>
                          <div class="carousel-inner">
                            <div class="carousel-item active">
                              <img class="d-block w-100" alt="First slide [800x400]" style="height: 70%; width: 60%;" src="{{ (media['path'])[0] }}" data-holder-rendered="true">
                            </div>
                              {% for y in (1, (len(media['path'])-1)) %}
                                <div class="carousel-item">
                                  <img class="d-block w-100" alt="Slide [800x400]" style="height: 70%; width: 60%;" src="{{ (media['path'])[y] }}" data-holder-rendered="true">
                                </div>
                              {% endfor %}
                          </div>
                          <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                            <span class="sr-only">Previous</span>
                          </a>
                          <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                            <span class="sr-only">Next</span>
                          </a>
                        </div>
                  {% else %}
                    <empty></empty>
                  {% endif %}
                {% endfor %}
              {% endif %}<br/>
              <div style="font-size:15px;font-style:arial;">{{ post.post_content['post'] }}</div>
            </article>
            <p></p>
            <footer>Posted --<span id='ago{{ post.post_id }}'>{{ time_ago(post.timestamp) }}</span> 
              {% if user.id == post.user_id %} 
              -----
              <button class="btn" onClick="location.href='/edit/{{ post.post_id }}'">Edit Post</button>
              -----
              <button class="btn" onClick="myFunctions(action='delete', postid='{{post.post_id}}', section='delete{{post.post_id}}')">Delete</button>
              {% endif %}
              <br> {% if check_if_liked(user, post.post_id) == True %}
              <btn id="unlike{{post.post_id}}">
                <button class="btn btn-default" onClick="myFunctions(action='unlike', postid='{{post.post_id}}', section='unlike{{post.post_id}}')"
                  type="button" style="color:#873beb;background-image:url(&quot;none&quot;);background-color:transparent;">
                  <i class="glyphicon glyphicon-heart" data-aos="flip-right"></i>
                  <span>{{ get_likes(post.post_id, count=True) }} Likes</span>
                </button>
              </btn>
              {% else %}
              <btn id="like{{post.post_id}}">
                <button class="btn btn-default" onClick="myFunctions(action='like', postid='{{post.post_id}}', section='like{{post.post_id}}')"
                  type="button" style="color:#eb3b60;background-image:url(&quot;none&quot;);background-color:transparent;">
                  <i class="glyphicon glyphicon-heart" data-aos="flip-right"></i>
                  <span>{{ get_likes(post.post_id, count=True) }} Likes</span>
                </button>
              </btn>
              {% endif %}
              <button class="btn btn-default comment" onclick="showCommentsModal(postid='{{post.post_id}}')" type="button" style="color:#eb3b60;background-image:url(&quot;none&quot;);background-color:transparent;">
                <i class="glyphicon glyphicon-flash" style="color:#f9d616;"></i>
                <span style="color:#f9d616;"> Comments</span>
              </button>
              <button class="btn btn-default" id="share" type="button" style="color:#eb3b8c;background-image:url(&quot;none&quot;);background-color:transparent;">
                <i class="glyphicon glyphicon-heart" data-aos="flip-right"></i>
                <span>Share</span>
              </button>
            </footer>
          </blockquote>
          <div class="modal" id='cbox{{ post.post_id }}' role="dialog" tabindex="-1" style="padding-top:100px;">
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <button type="button" onclick="hideModal(postid='{{post.post_id}}')" class="close" data-dismiss="modal" aria-label="Close">
                    <span >×</span>
                  </button>
                  <h4 class="modal-title">Comments</h4>
                </div>
                <div class="modal-body" id="cbody{{post.post_id}}" style="max-height: 400px; overflow-y: auto">
                </div>
                <div class="modal-footer">
                  <div>
                      <span style="color:#706f6b;text-align: right;"><count id="span{{post.post_id}}"  >{{ get_comments(post.post_id, count=True ) }}</count></span>
                    <input required='' id="comment{{post.post_id}}" type="text">
                    <button class="btn btn-default" type="button" onclick="postComments(postid='{{post.post_id}}')">Post Comment</button>
                  </div>
                  <button class="btn btn-default" type="button" onclick="hideModal(postid='{{post.post_id}}')">Close</button>
                </div>
              </div>
            </div>
          </div>
        </li>
        {% endif %} {% endwith %} {% endif %} {% else %}
        <p>No Posts Yet</p>
        {% endfor%}
      </ul>
    </div>
    <div>
      <br/>
    </div>
  </div>
  <!--center><div class="loader"></div></center-->
 <div class="totopshow">
        <a href="#" class="back-to-top"><img alt="Back to Top" src="/statics/avatar/gototop0.png"/></a>
    </div><!-- totopshow -->  
<div id="disqus_thread" class="disqus-loading">
  <center>
    <div>
      <span  id="loader" class="spinner spinner_large">
        <span class="spinner__dot spinner__dot_1"></span>
        <span class="spinner__dot spinner__dot_2"></span>
        <span class="spinner__dot spinner__dot_3"></span>
      </span>
    </div>
  </center>
</div>
<br/>

</main>

{% endblock %}